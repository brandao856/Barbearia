<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>BRAND√ÉO ‚Ä¢ BARBER</title>
    
    <!-- FONTES -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;800;900&family=Cormorant+Garamond:wght@300;400;500;600;700&family=Montserrat:wght@200;300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- SUPABASE -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        /* (todo seu CSS continua exatamente igual - n√£o vou repetir pra n√£o poluir, mas mantenha todo o CSS que voc√™ j√° tinha) */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            background-color: #0A0A0A;
            color: #E5E5E5;
            font-family: 'Cormorant Garamond', serif;
            line-height: 1.8;
            overflow-x: hidden;
        }
        /* COLE AQUI TODO O SEU CSS EXISTENTE */
        /* ... TODO O SEU CSS ... */
    </style>
</head>
<body>
    <!-- WHATSAPP -->
    <a href="https://wa.me/5591985601098" class="whatsapp-button" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- MODAL CONFIRMA√á√ÉO -->
    <div class="modal-overlay" id="modalConfirmacao">
        <div class="modal">
            <div class="modal-icon"><i class="fas fa-cut"></i></div>
            <h3>CONFIRMADO</h3>
            <div class="modal-detalhes" id="modalDetalhes"></div>
            <button class="modal-btn" onclick="fecharModal()">PERFEITO</button>
        </div>
    </div>

    <!-- BACK TO TOP -->
    <button class="back-to-top" id="backToTop"><i class="fas fa-arrow-up"></i></button>

    <div class="container">
        <!-- HEADER -->
        <header>
            <div style="display:flex; justify-content:center; margin:40px 0;">
                <a href="https://ibb.co/pj2wNhpv" target="_blank">
                    <img 
                        src="https://i.ibb.co/XxXL6YTZ/Design-sem-nome.png" 
                        alt="Design-sem-nome"
                        class="logo-img"
                    >
                </a>
            </div>
            
            <div class="since">BARBER</div>
            <nav>
                <ul>
                    <li><a href="#cortes" class="nav-link">Cortes</a></li>
                    <li><a href="#barba" class="nav-link">Barba</a></li>
                    <li><a href="#profissionais" class="nav-link">Profissional</a></li>
                    <li><a href="#agendamento" class="nav-link">Agendar</a></li>
                </ul>
            </nav>
        </header>

        <!-- CORTES -->
        <section id="cortes">
            <div class="section-header">
                <h2 class="section-title"><span>‚ú¶</span> CORTES <span>‚ú¶</span></h2>
                <div class="section-subtitle">Tradi√ß√£o e Estilo</div>
            </div>
            <div class="pricing-grid">
                <div class="price-card">
                    <h3>CORTE</h3>
                    <div class="price-value">R$ 30<small>,00</small></div>
                    <button class="btn-card agendar-btn" data-servico="Corte">AGENDAR</button>
                </div>
                <div class="price-card">
                    <h3>CABELO + BARBA</h3>
                    <div class="price-value">R$ 40<small>,00</small></div>
                    <button class="btn-card agendar-btn" data-servico="Cabelo e Barba">AGENDAR</button>
                </div>
                <div class="price-card">
                    <h3>CORTE + PIGMENTA√á√ÉO</h3>
                    <div class="price-value">R$ 40<small>,00</small></div>
                    <button class="btn-card agendar-btn" data-servico="Corte e Pigmenta√ß√£o">AGENDAR</button>
                </div>
                <div class="price-card">
                    <h3>CORTE + HIDRATA√á√ÉO</h3>
                    <div class="price-value">R$ 45<small>,00</small></div>
                    <button class="btn-card agendar-btn" data-servico="Corte e Hidrata√ß√£o">AGENDAR</button>
                </div>
                <div class="price-card">
                    <h3>CORTE + LIMPEZA DE PELE</h3>
                    <div class="price-value">R$ 40<small>,00</small></div>
                    <button class="btn-card agendar-btn" data-servico="Corte e Limpeza de Pele">AGENDAR</button>
                </div>
                <div class="price-card">
                    <h3>COMBO</h3>
                    <div class="price-value">R$ 40<small>,00</small></div>
                    <ul><li>Corte + Barba</li></ul>
                    <button class="btn-card agendar-btn" data-servico="Combo">AGENDAR</button>
                </div>
            </div>
        </section>

        <!-- BARBA -->
        <section id="barba">
            <div class="section-header">
                <h2 class="section-title"><span>‚ú¶</span> BARBA <span>‚ú¶</span></h2>
                <div class="section-subtitle">Arte e Sofistica√ß√£o</div>
            </div>
            <div class="pricing-grid">
                <div class="price-card">
                    <h3>BARBA COMPLETA</h3>
                    <div class="price-value">R$ 35<small>,00</small></div>
                    <button class="btn-card agendar-btn" data-servico="Barba Completa">AGENDAR</button>
                </div>
                <div class="price-card">
                    <h3>DESENHO</h3>
                    <div class="price-value">R$ 20<small>,00</small></div>
                    <button class="btn-card agendar-btn" data-servico="Desenho">AGENDAR</button>
                </div>
            </div>
        </section>

        <!-- PROFISSIONAIS -->
        <section id="profissionais">
            <div class="section-header">
                <h2 class="section-title"><span>‚ú¶</span> PROFISSIONAL <span>‚ú¶</span></h2>
                <div class="section-subtitle">Artes√£o da Navalha</div>
            </div>
            <div class="profissionais-grid">
                <div class="profissional-card">
                    <div class="profissional-nome">BRAND√ÉO</div>
                    <div class="cargo">MASTER BARBER</div>
                    <div style="color:#C0C0C0; font-size: 22px; margin:20px 0;">
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </div>
                    <div style="font-size: 18px; font-style: italic; color: #DDD; max-width:400px; margin:0 auto;">
                        "Tradi√ß√£o e excel√™ncia em cada movimento."
                    </div>
                    <div style="margin-top:20px;">
                        <a href="https://www.instagram.com/brandaoo__?igsh=Njc0dGV6Ymgxa2cx" target="_blank" style="color:#C0C0C0; text-decoration:none; font-size:16px; border:1px solid #C0C0C0; padding:10px 25px; border-radius:40px; display:inline-block;">
                            <i class="fab fa-instagram"></i> @brandaoo__
                        </a>
                    </div>
                </div>
            </div>

            <!-- HOR√ÅRIOS -->
            <div class="horarios-card">
                <div class="horario-item">
                    <div class="dia">TER√áA A S√ÅBADO</div>
                    <div class="hora">09:00 ‚Äî 11:00</div>
                    <div class="hora">15:00 ‚Äî 20:00</div>
                    <span class="status ativo">ABERTO</span>
                </div>
                <div class="horario-item">
                    <div class="dia">DOMINGO</div>
                    <div class="hora">FECHADO</div>
                    <span class="status">DESCANSO</span>
                </div>
                <div class="horario-item">
                    <div class="dia">SEGUNDA</div>
                    <div class="hora">FECHADO</div>
                    <span class="status">DESCANSO</span>
                </div>
            </div>
        </section>

        <!-- AGENDAMENTO -->
        <section id="agendamento">
            <div class="section-header">
                <h2 class="section-title"><span>‚ú¶</span> AGENDAR <span>‚ú¶</span></h2>
                <div class="section-subtitle">Reserve seu hor√°rio</div>
            </div>
            <div class="form-container">
                <form id="bookingForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label><i class="fas fa-user"></i> NOME</label>
                            <input type="text" id="nome" placeholder="Seu nome" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-phone-alt"></i> WHATSAPP</label>
                            <input type="tel" id="whatsapp" placeholder="(91) 99999-9999" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-cut"></i> SERVI√áO</label>
                            <select id="servico" required>
                                <option value="">SELECIONE</option>
                                <optgroup label="CORTES">
                                    <option value="Corte">CORTE - R$30</option>
                                    <option value="Cabelo e Barba">CABELO + BARBA - R$40</option>
                                    <option value="Corte e Pigmenta√ß√£o">CORTE + PIGMENTA√á√ÉO - R$40</option>
                                    <option value="Corte e Hidrata√ß√£o">CORTE + HIDRATA√á√ÉO - R$45</option>
                                    <option value="Corte e Limpeza de Pele">CORTE + LIMPEZA DE PELE - R$40</option>
                                    <option value="Combo">COMBO - R$40</option>
                                </optgroup>
                                <optgroup label="BARBA">
                                    <option value="Barba Completa">BARBA COMPLETA - R$35</option>
                                    <option value="Desenho">DESENHO - R$20</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-calendar-alt"></i> DATA</label>
                            <input type="date" id="data" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-clock"></i> HOR√ÅRIO</label>
                            <div id="horariosContainer" class="horarios-disponiveis"></div>
                            <input type="hidden" id="horarioSelecionado">
                            <div class="legenda-horarios">
                                <span><span style="background:#2A5C2A; width:12px; height:12px; display:inline-block; border-radius:2px;"></span> Dispon√≠vel</span>
                                <span><span style="background:#8B3A3A; width:12px; height:12px; display:inline-block; border-radius:2px;"></span> Ocupado</span>
                                <span><span style="background:#C0C0C0; width:12px; height:12px; display:inline-block; border-radius:2px;"></span> Selecionado</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-comment"></i> OBS</label>
                            <textarea id="observacoes" rows="2" placeholder="Observa√ß√µes"></textarea>
                        </div>
                    </div>
                    <div class="resumo-box">
                        <h4>RESUMO</h4>
                        <div id="resumoConteudo">
                            <div class="resumo-linha"><span class="resumo-label">Cliente:</span><span class="resumo-valor" id="resumoNome">‚Äî</span></div>
                            <div class="resumo-linha"><span class="resumo-label">Servi√ßo:</span><span class="resumo-valor" id="resumoServico">‚Äî</span></div>
                            <div class="resumo-linha"><span class="resumo-label">Data/Hora:</span><span class="resumo-valor" id="resumoDataHora">‚Äî</span></div>
                        </div>
                    </div>
                    <button type="submit" class="btn-submit">CONFIRMAR</button>
                </form>
            </div>
        </section>

        <!-- FOOTER -->
        <footer>
            <div class="footer-content">
                <div>
                    <div class="footer-logo">BRAND√ÉO</div>
                    <div style="color:#C0C0C0;">BARBER</div>
                </div>
                <div class="footer-info">
                    <div><i class="fas fa-map-marker-alt"></i> Salin√≥polis, PA</div>
                    <div><i class="fas fa-phone-alt"></i> (91) 98560-1098</div>
                </div>
                <div class="footer-info">
                    <div><i class="fas fa-clock"></i> Ter-S√°b: 9h-11h / 15h-20h</div>
                    <div><i class="fas fa-clock"></i> Dom/Seg: FECHADO</div>
                    <div class="social-links">
                        <a href="https://www.instagram.com/brandaoo__?igsh=Njc0dGV6Ymgxa2cx" class="social-link" target="_blank"><i class="fab fa-instagram"></i></a>
                        <a href="https://wa.me/5591985601098" class="social-link" target="_blank"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
            </div>
            <div class="copy">¬© 2024 BRAND√ÉO BARBER</div>
        </footer>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // ============================================
        // SUPABASE - INICIALIZA√á√ÉO CORRETA
        // ============================================
        // Configura√ß√µes do Supabase
        const SUPABASE_URL = 'https://kidwmyvmcnolesacnqok.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtpZHdteXZtY25vbGVzYWNucW9rIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE0Njk0ODksImV4cCI6MjA4NzA0NTQ4OX0.jWVC_wjUdOaO3JegiOactbBRMIf5Dd3W5wxCYrl9T2E';
        
        // Inicializar cliente Supabase
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        console.log('‚úÖ Supabase inicializado');
        
        // Inicializar AOS
        AOS.init({ once: true, duration: 800, offset: 100 });
        
        // Hor√°rios fixos dispon√≠veis
        const horariosFixos = ['09:00','10:00','11:00','15:00','16:00','17:00','18:00','19:00','20:00'];

        // ============================================
        // FUN√á√ïES DO SISTEMA
        // ============================================
        
        // Carregar hor√°rios do banco
        async function carregarHorarios() {
            const data = document.getElementById('data').value;
            const container = document.getElementById('horariosContainer');
            
            if (!data) {
                container.innerHTML = '<div style="grid-column: span 3; text-align: center; padding: 15px;">Selecione uma data</div>';
                return;
            }
            
            const dataObj = new Date(data + 'T12:00:00');
            const diaSemana = dataObj.getDay();
            
            // Verificar se √© fim de semana
            if (diaSemana === 0 || diaSemana === 1) {
                container.innerHTML = '<div style="grid-column: span 3; text-align: center; padding: 15px; color: #C0C0C0;">‚õî FECHADO - Ter√ßa a S√°bado</div>';
                return;
            }
            
            try {
                // Buscar agendamentos do dia
                const { data: agendamentosDB, error } = await supabase
                    .from('agendamentos')
                    .select('horario')
                    .eq('data', data);
                
                if (error) {
                    console.error('Erro na consulta:', error);
                    throw error;
                }
                
                const horariosOcupados = agendamentosDB ? agendamentosDB.map(a => a.horario) : [];
                
                // Criar bot√µes de hor√°rio
                container.innerHTML = horariosFixos.map(horario => {
                    const ocupado = horariosOcupados.includes(horario);
                    return `<button type="button" class="horario-btn ${ocupado ? 'indisponivel' : 'disponivel'}" 
                        data-horario="${horario}" ${ocupado ? 'disabled' : ''}>${horario}</button>`;
                }).join('');
                
                // Adicionar eventos aos bot√µes dispon√≠veis
                document.querySelectorAll('.horario-btn.disponivel').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.horario-btn').forEach(b => b.classList.remove('selecionado'));
                        this.classList.add('selecionado');
                        document.getElementById('horarioSelecionado').value = this.dataset.horario;
                        atualizarResumo();
                    });
                });
                
            } catch (error) {
                console.error('Erro ao carregar hor√°rios:', error);
                container.innerHTML = '<div style="grid-column: span 3; text-align: center; padding: 15px; color: #B22222;">Erro ao carregar hor√°rios</div>';
            }
        }

        // Atualizar resumo do agendamento
        function atualizarResumo() {
            const nome = document.getElementById('nome').value || '‚Äî';
            const servicoSelect = document.getElementById('servico');
            const servicoText = servicoSelect.options[servicoSelect.selectedIndex]?.text || '‚Äî';
            const data = document.getElementById('data').value;
            const horario = document.getElementById('horarioSelecionado').value;
            
            document.getElementById('resumoNome').innerText = nome;
            document.getElementById('resumoServico').innerText = servicoText;
            
            let dataHora = '‚Äî';
            if (data && horario) {
                const dataObj = new Date(data + 'T12:00:00');
                dataHora = `${dataObj.toLocaleDateString('pt-BR')} ${horario}`;
            }
            document.getElementById('resumoDataHora').innerText = dataHora;
        }

        // Fechar modal
        window.fecharModal = function() {
            document.getElementById('modalConfirmacao').classList.remove('active');
        };

        // ============================================
        // INICIALIZA√á√ÉO
        // ============================================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ P√°gina carregada, iniciando...');
            
            // Configurar data atual
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('data').value = hoje;
            document.getElementById('data').min = hoje;
            
            // Carregar hor√°rios iniciais
            await carregarHorarios();
            
            // Event listeners
            document.getElementById('data').addEventListener('change', function() {
                carregarHorarios();
                atualizarResumo();
            });
            
            document.getElementById('nome').addEventListener('input', atualizarResumo);
            document.getElementById('servico').addEventListener('change', atualizarResumo);
            
            // Bot√µes de agendamento r√°pido nos cards
            document.querySelectorAll('.agendar-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('agendamento').scrollIntoView({ behavior: 'smooth' });
                    const select = document.getElementById('servico');
                    const servicoNome = this.dataset.servico;
                    
                    for (let option of select.options) {
                        if (option.value === servicoNome || option.text.includes(servicoNome)) {
                            select.value = option.value;
                            break;
                        }
                    }
                    atualizarResumo();
                });
            });
            
            // Submit do formul√°rio
            document.getElementById('bookingForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                console.log('üìù Formul√°rio enviado');
                
                const dados = {
                    nome: document.getElementById('nome').value,
                    whatsapp: document.getElementById('whatsapp').value,
                    servico: document.getElementById('servico').value,
                    data: document.getElementById('data').value,
                    horario: document.getElementById('horarioSelecionado').value,
                    observacoes: document.getElementById('observacoes').value
                };
                
                // Validar campos
                if (!dados.nome || !dados.whatsapp || !dados.servico || !dados.data || !dados.horario) {
                    alert('‚ùå Preencha todos os campos obrigat√≥rios!');
                    return;
                }
                
                // Validar dia da semana
                const dataObj = new Date(dados.data + 'T12:00:00');
                const diaSemana = dataObj.getDay();
                if (diaSemana === 0 || diaSemana === 1) {
                    alert('‚õî Fechado neste dia! Funcionamos de Ter√ßa a S√°bado.');
                    return;
                }
                
                try {
                    console.log('üíæ Salvando no Supabase...', dados);
                    
                    // Verificar se hor√°rio ainda est√° dispon√≠vel
                    const { data: ocupados, error: checkError } = await supabase
                        .from('agendamentos')
                        .select('*')
                        .eq('data', dados.data)
                        .eq('horario', dados.horario);
                    
                    if (checkError) {
                        console.error('Erro ao verificar:', checkError);
                        throw checkError;
                    }
                    
                    if (ocupados && ocupados.length > 0) {
                        alert('‚è∞ Este hor√°rio acabou de ser ocupado! Escolha outro.');
                        await carregarHorarios();
                        return;
                    }
                    
                    // Inserir no banco
                    const { error: insertError } = await supabase
                        .from('agendamentos')
                        .insert([dados]);
                    
                    if (insertError) {
                        console.error('Erro ao inserir:', insertError);
                        throw insertError;
                    }
                    
                    console.log('‚úÖ Agendamento salvo com sucesso!');
                    
                    // Formatar data para exibi√ß√£o
                    const dataFormatada = dataObj.toLocaleDateString('pt-BR');
                    
                    // Enviar WhatsApp
                    const mensagem = `ü™í *NOVO AGENDAMENTO* ü™í%0A%0Aüë§ *Cliente:* ${dados.nome}%0Aüìû *WhatsApp:* ${dados.whatsapp}%0Aüíà *Servi√ßo:* ${dados.servico}%0AüìÖ *Data:* ${dataFormatada}%0A‚è∞ *Hor√°rio:* ${dados.horario}%0Aüìù *Obs:* ${dados.observacoes || 'Sem observa√ß√µes'}`;
                    
                    window.open(`https://wa.me/5591985601098?text=${mensagem}`, '_blank');
                    
                    // Mostrar modal de confirma√ß√£o
                    document.getElementById('modalDetalhes').innerHTML = `
                        <div>‚úÖ ${dados.nome}, seu agendamento foi confirmado!</div>
                        <div style="color:#C0C0C0; margin: 10px 0; font-size: 24px;">${dados.servico}</div>
                        <div style="font-size: 20px;">${dataFormatada} ‚Ä¢ ${dados.horario}</div>
                    `;
                    document.getElementById('modalConfirmacao').classList.add('active');
                    
                    // Limpar formul√°rio
                    this.reset();
                    document.getElementById('data').value = hoje;
                    document.getElementById('horarioSelecionado').value = '';
                    
                    // Recarregar hor√°rios
                    await carregarHorarios();
                    atualizarResumo();
                    
                } catch (error) {
                    console.error('‚ùå Erro no agendamento:', error);
                    alert('Erro ao realizar agendamento. Tente novamente.');
                }
            });
            
            // Back to top
            document.getElementById('backToTop').addEventListener('click', () => 
                window.scrollTo({ top: 0, behavior: 'smooth' }));
            
            window.addEventListener('scroll', () => {
                const btn = document.getElementById('backToTop');
                if (window.scrollY > 300) {
                    btn.classList.add('visible');
                } else {
                    btn.classList.remove('visible');
                }
            });
            
            // Fechar modal com ESC
            document.addEventListener('keydown', e => {
                if (e.key === 'Escape') {
                    document.getElementById('modalConfirmacao').classList.remove('active');
                }
            });
            
            console.log('‚úÖ Sistema inicializado com sucesso!');
        });
    </script>
</body>
</html>
